<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> GSOC: Phase 1 Overview | Thinkspace </title> <meta name="description" content=" A Brief overview of my phase 1 work "> <meta name="keywords" content="GSoC, internship, Nested Languages"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Facebook / Open Graph --> <meta property="og:type" content="article"> <meta property="article:author" content="Naveen Naidu"> <meta property="article:section" content="gsoc-2019"> <meta property="article:tag" content="GSoC, internship, Nested Languages"> <meta property="article:published_time" content="2019-06-28 00:00:00 +0530"> <meta property="og:url" content="http://localhost:4000/2019/GSoC-Phase-1/"> <meta property="og:title" content=" GSOC: Phase 1 Overview | Thinkspace "> <meta property="og:image" content="http://localhost:4000"> <meta property="og:description" content=" A Brief overview of my phase 1 work "> <meta property="og:site_name" content="Naveen Naidu"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content=""> <meta name="twitter:title" content=" GSOC: Phase 1 Overview | Thinkspace "> <meta name="twitter:description" content=" A Brief overview of my phase 1 work "> <meta name="twitter:image:src" content="http://localhost:4000"> <!-- Social: Google+ / Schema.org --> <meta itemprop="name" content=" GSOC: Phase 1 Overview | Thinkspace "> <meta itemprop="description" content=" A Brief overview of my phase 1 work "> <meta itemprop="image" content="http://localhost:4000"> <!-- Canonical link tag --> <link rel="canonical" href="http://localhost:4000/2019/GSoC-Phase-1/"> <link rel="alternate" type="application/rss+xml" title="Thinkspace" href="http://localhost:4000/feed.xml"> <!-- rel prev and next --> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css"> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="http://localhost:4000/">Think<span>space</span></a></h1> <ul class="navbar"> <li><a href="http://localhost:4000/about">About me</a></li> <li><a href="http://localhost:4000/daily_journal" target="_blank">Daily Log</a></li> <li><a href="http://localhost:4000/categories" target="_blank">Categories</a></li> <li><a href="http://localhost:4000/feed.xml" target="_blank">RSS</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"><time datetime="2019-06-28T00:00:00+05:30" itemprop="datePublished">Jun 28, 2019</time></p> <h1 class="post-title" itemprop="name headline">GSOC: Phase 1 Overview</h1> </header> <div class="post-content" itemprop="articleBody"> <p>Hiya crawlers!</p> <p>This post will cover my learnings of phase 1 of GSoC with coala. As I explained in my previous GSOC post about the 4 different phases of my project. For the uninitatied, the project for my GSoC is to add functionality into coala which would enable it into <code class="highlighter-rouge">Linting files that have nested languages</code>.</p> <p>I divided my project into 4 phases:</p> <ul> <li>Information Gathering</li> <li>Segregating the nested file</li> <li>Linting the file</li> <li>Assembling</li> </ul> <p>For the newbies here, I highly suggest that you read the previous blog about the project. If you do feel lazy(when don’t we :P) to go through the 700+ lines of content, I better give you a very high level view of the project:</p> <h2 id="a-higher-level-view-of-the-implementation">A higher level view of the implementation</h2> <p>A source file containing multiple programming languages is loaded up by coala. The original nested file is broken/split into <code class="highlighter-rouge">n</code> temporary files, where n is the number of languages present in the original file. Each temporary file only contains the snippets belonging to one language.</p> <p>These temporary files would then be passed to their respective language bears ( <em>chosen by the user</em>) where the static analysis routines would run. The temporary files after being linted would then be assembled. The above process creates the illusion that the original file is being linted, but in reality we divide the files into different parts and lint them one by one.</p> <p>The figure below, would help give a clear picture</p> <p><img src="/assets/images/4-gsoc-overview-nested-languages/high_level_view_handle_nested.jpg" alt="higher_level_view" /></p> <p>If it’s hard for you imagine - Think of it something like this, You are a factory worker working in a ball manufacturing company. This company produces two kind of balls - One <code class="highlighter-rouge">red</code> and one <code class="highlighter-rouge">blue</code>. Both these balls have differnt properties and shapes. This factory is equipped with a Big <code class="highlighter-rouge">Ball Production Unit</code>, but alas - This unit produces both red and blue balls at the same time.As a result of which after one production cycle the output box/carton has mixture of <code class="highlighter-rouge">Red</code> and <code class="highlighter-rouge">Blue</code> balls.</p> <p>Your taks as a factory worker is to segregate the <code class="highlighter-rouge">red</code> and <code class="highlighter-rouge">blue</code> balls into different boxes and take these to the <code class="highlighter-rouge">Ball Testers</code>. Since the balls have different properties, you cannot take it to the same testers, hence you will take the Blue Ball to the <code class="highlighter-rouge">Blue Ball Validator</code> and Red Ball to the <code class="highlighter-rouge">Red Ball Validator</code>.</p> <p>These Validator validates the quality of the ball and discard the bad quality balls and replaces them with a nice quality balls.</p> <p>Once the Validation is done, You now have two boxes - One for Red balls with no defects and one for Blue Balls with no defects. Your final job is to combine both these boxes. (Factory worker thinks: <em>Duh! Why did you make me segregate the ball in the first place -.-</em>)</p> <p>The above analogy is what my work is all about. The factory worker is the coala tool. The ball tester are the coala bears/linters. The carton/box is the nested file that had mixture of languages(<em>read balls</em>). The nested file(<em>the box with the mixture of two different color balls</em>) is seperated into two different section where each section contains the lines of only one language(<em>read, the red and blue ball from the box is segeragated into <code class="highlighter-rouge">red box</code> and <code class="highlighter-rouge">Blue Box</code></em>).</p> <p>These sections that contain purely only one language(boxes with only one single color ball) is then taken to the respective coala-bears(<em>read <code class="highlighter-rouge">Ball validators</code></em>), these coala bears validates the files and fixes the file if any change needs to be done (<em>Note: coala-bears are linters</em>) and then send theses validated/linted file back to coala(the two box with proper quality balls are handed back to factory worker). coala then finally mereges back both the files (<em>read: Factory worker then puts both the validated balls back into the same box</em>)</p> <hr /> <h2 id="phase-1-work">Phase 1 Work</h2> <p>In Phase 1 of GSoC I decided to first handle the task of <code class="highlighter-rouge">segregating the nested file</code> into different sections. My aim in this phase was to be able to identify the sections that belongs to a particular language.</p> <p>Let’s understand what this means:</p> <p>Suppose we have the following nested file which has both Jinja and Python.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">thanos</span>

<span class="n">x</span> <span class="o">=</span> <span class="s">"hulk"</span>

<span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s">"hulk"</span> <span class="o">%</span><span class="p">}</span>
	<span class="k">print</span><span class="p">(</span><span class="s">"Thanos is meat"</span><span class="p">)</span> 
<span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
	<span class="k">print</span><span class="p">(</span><span class="s">"Bhubyee! Earth"</span><span class="p">)</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">x</span><span class="p">):</span>
	<span class="s">"Some gibberish"</span>
</code></pre></div></div> <p>As you see in the above snippet - We have a mixture of <code class="highlighter-rouge">Python</code> and <code class="highlighter-rouge">Jinja</code>. And if we have to be able to lint these files seprately i.e if we have to convert the above file into <code class="highlighter-rouge">pure jinja</code> and <code class="highlighter-rouge">pure python</code> file, we would need to maintain the information about what lines belong to which language.</p> <p>We do this, by divinding the files into different section. I call these section <code class="highlighter-rouge">NlSection</code> which stand for <code class="highlighter-rouge">Nested language Section</code>.</p> <p>The above snippet can be divided into three sections:</p> <ol> <li><strong>Section 1</strong></li> </ol> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">thanos</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">hulk</span>

</code></pre></div></div> <ol> <li><strong>Section 2</strong></li> </ol> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% if x == "hulk" %}
	print("Thanos is meat") 
{% else %}
	print("Bhubyee! Earth")
{% endif %}
</code></pre></div></div> <ol> <li><strong>Section 3</strong></li> </ol> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="p">(</span><span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">x</span><span class="p">):</span>
	<span class="k">print</span><span class="p">(</span><span class="s">"Some gibberish"</span><span class="p">)</span>
</code></pre></div></div> <p>Divinding the files into various sections, makes the work of linting the file easier. What we do after creating sections is that we group the sections on the basis of their language and then make <code class="highlighter-rouge">pure python</code> and a <code class="highlighter-rouge">pure jinja</code> file. These pure files would then be passed upon to the respective language bears.</p> <p><em>NOTE: Creating sections does mean that we create new sections rather I mean that we maintain the infromation such as the <code class="highlighter-rouge">line_start</code> and <code class="highlighter-rouge">line_end</code> in the original file.</em></p> <h3 id="nlsection">NlSection</h3> <p>Each of the section we made in the nested language file is termed as <code class="highlighter-rouge">NlSection</code>. A NlSection has the following information:</p> <ul> <li>Start line number of the section</li> <li>Start column number of the section</li> <li>End line number of the section</li> <li>End column number of the section</li> <li>The path of the nestedfile</li> </ul> <p>The start and end information of the sections are inturn a <code class="highlighter-rouge">NlSectionPosition</code> object.</p> <p>That means NlSection comprises of two object <code class="highlighter-rouge">start</code> and <code class="highlighter-rouge">end</code>, and these objects are of the type <code class="highlighter-rouge">NlSectionPosition</code>.</p> <p>NlSectionPosition has better functionality to store line numbers and column numbers along with proper testing.</p> <h3 id="parsers">Parsers</h3> <p>Parsers are responsible to take in the input nested file and split out the <code class="highlighter-rouge">NlSections</code> list. For my case - I have as of now only made a parser that can for the combination of <code class="highlighter-rouge">Jinja</code> and <code class="highlighter-rouge">Python</code>. I named it as <code class="highlighter-rouge">PyJinjaParser</code>.</p> <p>This parser can take in a nested Jinja and Python file and emit out the list of NlSections of Python and Jinja.</p> <p>The above explanation sums up pretty much my work for Phase 1. I wish to write about this in more details - but time bounds me :/</p> <hr /> <p><a href="https://github.com/Naveenaidu/coala/pull/2"><strong>The Link to Phase 1 PR</strong></a></p> <p>For now, I would refer you to the above PR link, I have seen to that it is well documented. Thanks to my mentor Virresh - I did write enough tests to give me peace of mind that the work until now works.</p> <hr /> <p>P.S:</p> <p>I have <strong>passed</strong> Phase 1. Hurrah!. I must thank my mentor for his valuable feedback and his patient reviews. Honestly I myself was skeptical of making it this far. You know, handling OMP, Exams and GSOC. But everything did work out fine. My final exam would be on 3rd of July. It’s python - So it’s pretty chill.</p> <p>So unofficially - My exams have already ended today :P</p> <p>Also, the community bonding of Open mainframe is done too. Stipend of both GSoC and OMP have been released. It kinda feel good. My Second salary :)</p> <p>Ahaaahhh! I gotta go now - How I wish I can write more. Alas! that’s it for now my dear bots. Saynora until next post :)</p> </div> </article> <footer class="site-footer"> <div class="container"> <small class="block">&copy; 2020 Naveen Naidu &middot; &lt;/&gt; Powered by <a href="https://jekyllrb.com/">Jekyll</a> and <a href="https://github.com/heiswayi/thinkspace">Thinkspace theme</a></small> </div> </footer> </main> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-XXXXX-XX']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </body> </html>
